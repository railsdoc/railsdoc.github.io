---
title: ActionController::TestCase::Behavior
layout: default
---
<div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 5.2.8</span><br />
        
        <div class="type">Module</div>
        <h1>
            ActionController::TestCase::Behavior
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/actionpack/lib/action_controller/test_case_rb.html">actionpack/lib/action_controller/test_case.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  

  

  
  


  
    <h2 id="namespace">Namespace</h2>

    
      <h3 id="module">Module</h3>
      <ul>
      
        <li><a href="Behavior/ClassMethods.html">ActionController::TestCase::Behavior::ClassMethods</a></li>
      
      </ul>
    

    
  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-build_response">build_response</a>
        </li>
      
        <li>
          <a href="#method-i-controller_class_name">controller_class_name</a>
        </li>
      
        <li>
          <a href="#method-i-delete">delete</a>
        </li>
      
        <li>
          <a href="#method-i-generated_path">generated_path</a>
        </li>
      
        <li>
          <a href="#method-i-get">get</a>
        </li>
      
        <li>
          <a href="#method-i-head">head</a>
        </li>
      
        <li>
          <a href="#method-i-patch">patch</a>
        </li>
      
        <li>
          <a href="#method-i-post">post</a>
        </li>
      
        <li>
          <a href="#method-i-process">process</a>
        </li>
      
        <li>
          <a href="#method-i-put">put</a>
        </li>
      
        <li>
          <a href="#method-i-query_parameter_names">query_parameter_names</a>
        </li>
      
        <li>
          <a href="#method-i-setup_controller_request_and_response">setup_controller_request_and_response</a>
        </li>
      
    </ul>
  

  
    <!-- Includes -->
    <h2 id="included-modules">Included Modules</h2>
    <ul>
      
        <li>
          
            <a href="../../ActionDispatch/TestProcess.html">
              ActionDispatch::TestProcess
            </a>
          
        </li>
      
        <li>
          
            <a href="../../ActiveSupport/Testing/ConstantLookup.html">
              ActiveSupport::Testing::ConstantLookup
            </a>
          
        </li>
      
        <li>
          
            Rails::Dom::Testing::Assertions
          
        </li>
      
        <li>
          
            <a href="../TemplateAssertions.html">
              ActionController::TemplateAssertions
            </a>
          
        </li>
      
        <li>
          
            <a href="../../ActionDispatch/Assertions.html">
              ActionDispatch::Assertions
            </a>
          
        </li>
      
    </ul>
  

  
    

    

    

    
      <!-- Section attributes -->
      <h2 id="attributes">Attributes</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>request</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>response</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    

    <!-- Methods -->
    
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-build_response">
            
              build_response(klass)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 588
      def build_response(klass)
        klass.create
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L588" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-controller_class_name">
            
              controller_class_name()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 548
      def controller_class_name
        @controller.class.anonymous? ? &quot;anonymous&quot; : @controller.class.controller_path
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L548" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-delete">
            
              delete(action, **args)
            
          </h3>

          
            <div class="description">
              <p>Simulate a DELETE request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 420
      def delete(action, **args)
        process(action, method: &quot;DELETE&quot;, **args)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L420" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-generated_path">
            
              generated_path(generated_extras)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 552
      def generated_path(generated_extras)
        generated_extras[0]
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L552" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-get">
            
              get(action, **args)
            
          </h3>

          
            <div class="description">
              <p>Simulate a GET request with the given parameters.</p>
<ul><li>
<p><code>action</code>: The controller action to call.</p>
</li><li>
<p><code>params</code>: The hash with HTTP parameters that you want to pass. This may be <code>nil</code>.</p>
</li><li>
<p><code>body</code>: The request body with a string that is appropriately encoded (<code>application/x-www-form-urlencoded</code> or <code>multipart/form-data</code>).</p>
</li><li>
<p><code>session</code>: A hash of parameters to store in the session. This may be <code>nil</code>.</p>
</li><li>
<p><code>flash</code>: A hash of parameters to store in the flash. This may be <code>nil</code>.</p>
</li></ul>

<p>You can also simulate POST, PATCH, PUT, DELETE, and HEAD requests with <code>post</code>, <code>patch</code>, <code>put</code>, <code>delete</code>, and <code>head</code>. Example sending parameters, session and setting a flash message:</p>

<pre><code>get :show,
  params: { id: 7 },
  session: { user_id: 1 },
  flash: { notice: &#39;This is flash message&#39; }
</code></pre>

<p>Note that the request method is not verified. The different methods are available to make the tests more expressive.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 394
      def get(action, **args)
        res = process(action, method: &quot;GET&quot;, **args)
        cookies.update res.cookies
        res
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L394" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-head">
            
              head(action, **args)
            
          </h3>

          
            <div class="description">
              <p>Simulate a HEAD request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 426
      def head(action, **args)
        process(action, method: &quot;HEAD&quot;, **args)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L426" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-patch">
            
              patch(action, **args)
            
          </h3>

          
            <div class="description">
              <p>Simulate a PATCH request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 408
      def patch(action, **args)
        process(action, method: &quot;PATCH&quot;, **args)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L408" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-post">
            
              post(action, **args)
            
          </h3>

          
            <div class="description">
              <p>Simulate a POST request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 402
      def post(action, **args)
        process(action, method: &quot;POST&quot;, **args)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L402" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-process">
            
              process(action, method: &quot;GET&quot;, params: nil, session: nil, body: nil, flash: {}, format: nil, xhr: false, as: nil)
            
          </h3>

          
            <div class="description">
              <p>Simulate an HTTP request to <code>action</code> by specifying request method, parameters and set/volley the response.</p>
<ul><li>
<p><code>action</code>: The controller action to call.</p>
</li><li>
<p><code>method</code>: Request method used to send the HTTP request. Possible values are <code>GET</code>, <code>POST</code>, <code>PATCH</code>, <code>PUT</code>, <code>DELETE</code>, <code>HEAD</code>. Defaults to <code>GET</code>. Can be a symbol.</p>
</li><li>
<p><code>params</code>: The hash with HTTP parameters that you want to pass. This may be <code>nil</code>.</p>
</li><li>
<p><code>body</code>: The request body with a string that is appropriately encoded (<code>application/x-www-form-urlencoded</code> or <code>multipart/form-data</code>).</p>
</li><li>
<p><code>session</code>: A hash of parameters to store in the session. This may be <code>nil</code>.</p>
</li><li>
<p><code>flash</code>: A hash of parameters to store in the flash. This may be <code>nil</code>.</p>
</li><li>
<p><code>format</code>: Request format. Defaults to <code>nil</code>. Can be string or symbol.</p>
</li><li>
<p><code>as</code>: Content type. Defaults to <code>nil</code>. Must be a symbol that corresponds to a mime type.</p>
</li></ul>

<p>Example calling <code>create</code> action and sending two params:</p>

<pre><code>process :create,
  method: &#39;POST&#39;,
  params: {
    user: { name: &#39;Gaurish Sharma&#39;, email: &#39;user@example.com&#39; }
  },
  session: { user_id: 1 },
  flash: { notice: &#39;This is flash message&#39; }
</code></pre>

<p>To simulate <code>GET</code>, <code>POST</code>, <code>PATCH</code>, <code>PUT</code>, <code>DELETE</code> and <code>HEAD</code> requests prefer using <a href="Behavior.html#method-i-get"><code>get</code></a>, <a href="Behavior.html#method-i-post"><code>post</code></a>, <a href="Behavior.html#method-i-patch"><code>patch</code></a>, <a href="Behavior.html#method-i-put"><code>put</code></a>, <a href="Behavior.html#method-i-delete"><code>delete</code></a> and <a href="Behavior.html#method-i-head"><code>head</code></a> methods respectively which will make tests more expressive.</p>

<p>Note that the request method is not verified.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 460
      def process(action, method: &quot;GET&quot;, params: nil, session: nil, body: nil, flash: {}, format: nil, xhr: false, as: nil)
        check_required_ivars

        action = action.to_s.dup
        http_method = method.to_s.upcase

        @html_document = nil

        cookies.update(@request.cookies)
        cookies.update_cookies_from_jar
        @request.set_header &quot;HTTP_COOKIE&quot;, cookies.to_header
        @request.delete_header &quot;action_dispatch.cookies&quot;

        @request          = TestRequest.new scrub_env!(@request.env), @request.session, @controller.class
        @response         = build_response @response_klass
        @response.request = @request
        @controller.recycle!

        if body
          @request.set_header &quot;RAW_POST_DATA&quot;, body
        end

        @request.set_header &quot;REQUEST_METHOD&quot;, http_method

        if as
          @request.content_type = Mime[as].to_s
          format ||= as
        end

        parameters = (params || {}).symbolize_keys

        if format
          parameters[:format] = format
        end

        generated_extras = @routes.generate_extras(parameters.merge(controller: controller_class_name, action: action))
        generated_path = generated_path(generated_extras)
        query_string_keys = query_parameter_names(generated_extras)

        @request.assign_parameters(@routes, controller_class_name, action, parameters, generated_path, query_string_keys)

        @request.session.update(session) if session
        @request.flash.update(flash || {})

        if xhr
          @request.set_header &quot;HTTP_X_REQUESTED_WITH&quot;, &quot;XMLHttpRequest&quot;
          @request.fetch_header(&quot;HTTP_ACCEPT&quot;) do |k|
            @request.set_header k, [Mime[:js], Mime[:html], Mime[:xml], &quot;text/xml&quot;, &quot;*/*&quot;].join(&quot;, &quot;)
          end
        end

        @request.fetch_header(&quot;SCRIPT_NAME&quot;) do |k|
          @request.set_header k, @controller.config.relative_url_root
        end

        begin
          @controller.recycle!
          @controller.dispatch(action, @request, @response)
        ensure
          @request = @controller.request
          @response = @controller.response

          if @request.have_cookie_jar?
            unless @request.cookie_jar.committed?
              @request.cookie_jar.write(@response)
              cookies.update(@request.cookie_jar.instance_variable_get(:@cookies))
            end
          end
          @response.prepare!

          if flash_value = @request.flash.to_session_value
            @request.session[&quot;flash&quot;] = flash_value
          else
            @request.session.delete(&quot;flash&quot;)
          end

          if xhr
            @request.delete_header &quot;HTTP_X_REQUESTED_WITH&quot;
            @request.delete_header &quot;HTTP_ACCEPT&quot;
          end
          @request.query_string = &quot;&quot;

          @response.sent!
        end

        @response
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L460" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-put">
            
              put(action, **args)
            
          </h3>

          
            <div class="description">
              <p>Simulate a PUT request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 414
      def put(action, **args)
        process(action, method: &quot;PUT&quot;, **args)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L414" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-query_parameter_names">
            
              query_parameter_names(generated_extras)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 556
      def query_parameter_names(generated_extras)
        generated_extras[1] + [:controller, :action]
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L556" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-setup_controller_request_and_response">
            
              setup_controller_request_and_response()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_controller/test_case.rb, line 560
      def setup_controller_request_and_response
        @controller = nil unless defined? @controller

        @response_klass = ActionDispatch::TestResponse

        if klass = self.class.controller_class
          if klass &lt; ActionController::Live
            @response_klass = LiveTestResponse
          end
          unless @controller
            begin
              @controller = klass.new
            rescue
              warn &quot;could not construct controller #{klass}&quot; if $VERBOSE
            end
          end
        end

        @request          = TestRequest.create(@controller.class)
        @response         = build_response @response_klass
        @response.request = @request

        if @controller
          @controller.request = @request
          @controller.params = {}
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/26521331e5923a0c50fa50984d2f924e5f26c50b/actionpack/lib/action_controller/test_case.rb#L560" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>
