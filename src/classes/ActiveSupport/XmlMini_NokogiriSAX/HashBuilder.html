---
title: ActiveSupport::XmlMini_NokogiriSAX::HashBuilder
layout: default
---
<div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 8.1.0</span><br />
        
        <div class="type">Class</div>
        <h1>
            ActiveSupport::XmlMini_NokogiriSAX::HashBuilder
            
                <span class="parent">&lt;
                    
                    Nokogiri::XML::SAX::Document
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/activesupport/lib/active_support/xml_mini/nokogirisax_rb.html">activesupport/lib/active_support/xml_mini/nokogirisax.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p><a href="../../Class.html"><code>Class</code></a> that will build the hash while the XML document is being parsed using SAX events.</p>

    </div>
  

  

  
  


  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-cdata_block">cdata_block</a>
        </li>
      
        <li>
          <a href="#method-i-characters">characters</a>
        </li>
      
        <li>
          <a href="#method-i-current_hash">current_hash</a>
        </li>
      
        <li>
          <a href="#method-i-end_document">end_document</a>
        </li>
      
        <li>
          <a href="#method-i-end_element">end_element</a>
        </li>
      
        <li>
          <a href="#method-i-error">error</a>
        </li>
      
        <li>
          <a href="#method-i-start_document">start_document</a>
        </li>
      
        <li>
          <a href="#method-i-start_element">start_element</a>
        </li>
      
    </ul>
  

  

  
    

    

    
      <!-- Section constants -->
      <h2 id="constants">Constants</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">CONTENT_KEY</td>
            <td>=</td>
            <td class="attr-value">&quot;__content__&quot;</td>
          </tr>
          
        
          <tr valign='top'>
            <td class="attr-name">HASH_SIZE_KEY</td>
            <td>=</td>
            <td class="attr-value">&quot;__hash_size__&quot;</td>
          </tr>
          
        
      </table>
    

    
      <!-- Section attributes -->
      <h2 id="attributes">Attributes</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>hash</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    

    <!-- Methods -->
    
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-cdata_block"><code><b>cdata_block</b>(string)</code></h3>

          

          

          
            <p class="method__aka">
              Alias for:
              <a href="/classes/ActiveSupport/XmlMini_NokogiriSAX/HashBuilder.html#method-i-characters" class="ref-link"><code>characters</code></a>.
            </p>
          

          
          
        </div>
        
        <div class="method">
          <h3 id="method-i-characters"><code><b>characters</b>(string)</code></h3>

          

          
            <p class="method__aka">
              Also aliased as:
              
              <a href="/classes/ActiveSupport/XmlMini_NokogiriSAX/HashBuilder.html#method-i-cdata_block" class="ref-link"><code>cdata_block</code></a>.
            </p>
          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 61
def characters(string)
  current_hash[CONTENT_KEY] &lt;&lt; string
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L61" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-current_hash"><code><b>current_hash</b>()</code></h3>

          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 24
def current_hash
  @hash_stack.last
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L24" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-end_document"><code><b>end_document</b>()</code></h3>

          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 33
def end_document
  raise &quot;Parse stack not empty!&quot; if @hash_stack.size &gt; 1
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L33" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-end_element"><code><b>end_element</b>(name)</code></h3>

          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 54
def end_element(name)
  if current_hash.length &gt; current_hash.delete(HASH_SIZE_KEY) &amp;&amp; current_hash[CONTENT_KEY].blank? || current_hash[CONTENT_KEY] == &quot;&quot;
    current_hash.delete(CONTENT_KEY)
  end
  @hash_stack.pop
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L54" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-error"><code><b>error</b>(error_message)</code></h3>

          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 37
def error(error_message)
  raise error_message
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L37" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-start_document"><code><b>start_document</b>()</code></h3>

          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 28
def start_document
  @hash = {}
  @hash_stack = [@hash]
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L28" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-start_element"><code><b>start_element</b>(name, attrs = [])</code></h3>

          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/xml_mini/nokogirisax.rb, line 41
def start_element(name, attrs = [])
  new_hash = { CONTENT_KEY =&gt; +&quot;&quot; }.merge!(Hash[attrs])
  new_hash[HASH_SIZE_KEY] = new_hash.size + 1

  case current_hash[name]
  when Array then current_hash[name] &lt;&lt; new_hash
  when Hash  then current_hash[name] = [current_hash[name], new_hash]
  when nil   then current_hash[name] = new_hash
  end

  @hash_stack.push(new_hash)
end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/1cdd190a25e483b65f1f25bbd0f13a25d696b461/activesupport/lib/active_support/xml_mini/nokogirisax.rb#L41" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>
