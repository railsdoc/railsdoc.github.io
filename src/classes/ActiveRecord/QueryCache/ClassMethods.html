---
title: ActiveRecord::QueryCache::ClassMethods
layout: default
---
<div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 8.0.0</span><br />
        
        <div class="type">Module</div>
        <h1>
            ActiveRecord::QueryCache::ClassMethods
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/activerecord/lib/active_record/query_cache_rb.html">activerecord/lib/active_record/query_cache.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  

  

  
  


  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-cache">cache</a>
        </li>
      
        <li>
          <a href="#method-i-uncached">uncached</a>
        </li>
      
    </ul>
  

  

  
    

    

    

    

    <!-- Methods -->
    
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-cache">
            
              cache(&amp;block)
            
          </h3>

          
            <div class="description">
              <p>Enable the query cache within the block if Active Record is configured. If it‚Äôs not, it will execute the given block.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/query_cache.rb, line 9
      def cache(&amp;block)
        if connected? || !configurations.empty?
          pool = connection_pool
          was_enabled = pool.query_cache_enabled
          begin
            pool.enable_query_cache(&amp;block)
          ensure
            pool.clear_query_cache unless was_enabled
          end
        else
          yield
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/activerecord/lib/active_record/query_cache.rb#L9" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-uncached">
            
              uncached(dirties: true, &amp;block)
            
          </h3>

          
            <div class="description">
              <p>Disable the query cache within the block if Active Record is configured. If it‚Äôs not, it will execute the given block.</p>

<p>Set <code>dirties: false</code> to prevent query caches on all connections from being cleared by write operations. (By default, write operations dirty all connections‚Äô query caches in case they are replicas whose cache would now be outdated.)</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/query_cache.rb, line 28
      def uncached(dirties: true, &amp;block)
        if connected? || !configurations.empty?
          connection_pool.disable_query_cache(dirties: dirties, &amp;block)
        else
          yield
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/activerecord/lib/active_record/query_cache.rb#L28" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>
