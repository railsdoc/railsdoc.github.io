---
title: ActionDispatch::MiddlewareStack
layout: default
---
<div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 8.0.0</span><br />
        
        <div class="type">Class</div>
        <h1>
            ActionDispatch::MiddlewareStack
            
                <span class="parent">&lt;
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/actionpack/lib/action_dispatch/middleware/stack_rb.html">actionpack/lib/action_dispatch/middleware/stack.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="class-ActionDispatch::MiddlewareStack-label-Action+Dispatch+MiddlewareStack">Action Dispatch <a href="MiddlewareStack.html"><code>MiddlewareStack</code></a></h1>

<p>Read more about <a href="https://guides.rubyonrails.org/rails_on_rack.html#action-dispatcher-middleware-stack">Rails middleware stack</a> in the guides.</p>

    </div>
  

  

  
  


  
    <h2 id="namespace">Namespace</h2>

    

    
      <h3 id="class">Class</h3>
      <ul>
      
        <li><a href="MiddlewareStack/InstrumentationProxy.html">ActionDispatch::MiddlewareStack::InstrumentationProxy</a></li>
      
        <li><a href="MiddlewareStack/Middleware.html">ActionDispatch::MiddlewareStack::Middleware</a></li>
      
      </ul>
    
  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-5B-5D">[]</a>
        </li>
      
        <li>
          <a href="#method-i-build">build</a>
        </li>
      
        <li>
          <a href="#method-i-delete">delete</a>
        </li>
      
        <li>
          <a href="#method-i-delete-21">delete!</a>
        </li>
      
        <li>
          <a href="#method-i-each">each</a>
        </li>
      
        <li>
          <a href="#method-i-initialize_copy">initialize_copy</a>
        </li>
      
        <li>
          <a href="#method-i-insert">insert</a>
        </li>
      
        <li>
          <a href="#method-i-insert_after">insert_after</a>
        </li>
      
        <li>
          <a href="#method-i-insert_before">insert_before</a>
        </li>
      
        <li>
          <a href="#method-i-last">last</a>
        </li>
      
        <li>
          <a href="#method-i-move">move</a>
        </li>
      
        <li>
          <a href="#method-i-move_after">move_after</a>
        </li>
      
        <li>
          <a href="#method-i-move_before">move_before</a>
        </li>
      
        <li>
          <a href="#method-c-new">new</a>
        </li>
      
        <li>
          <a href="#method-i-size">size</a>
        </li>
      
        <li>
          <a href="#method-i-swap">swap</a>
        </li>
      
        <li>
          <a href="#method-i-unshift">unshift</a>
        </li>
      
        <li>
          <a href="#method-i-use">use</a>
        </li>
      
    </ul>
  

  
    <!-- Includes -->
    <h2 id="included-modules">Included Modules</h2>
    <ul>
      
        <li>
          
            <a href="../Enumerable.html">
              Enumerable
            </a>
          
        </li>
      
    </ul>
  

  
    

    

    

    
      <!-- Section attributes -->
      <h2 id="attributes">Attributes</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>middlewares</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    

    <!-- Methods -->
    
      <h2 id="class-public-methods">Class Public methods</h2>
      
        <div class="method">
          <h3 id="method-c-new">
            
              new(*args)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 76
    def initialize(*args)
      @middlewares = []
      yield(self) if block_given?
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L76" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-5B-5D">
            
              [](i)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 93
    def [](i)
      middlewares[i]
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L93" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-build">
            
              build(app = nil, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 166
    def build(app = nil, &amp;block)
      instrumenting = ActiveSupport::Notifications.notifier.listening?(InstrumentationProxy::EVENT_NAME)
      middlewares.freeze.reverse.inject(app || block) do |a, e|
        if instrumenting
          e.build_instrumented(a)
        else
          e.build(a)
        end
      end
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L166" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-delete">
            
              delete(target)
            
          </h3>

          
            <div class="description">
              <p>Deletes a middleware from the middleware stack.</p>

<p>Returns the array of middlewares not including the deleted item, or returns nil if the target is not found.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 131
    def delete(target)
      middlewares.reject! { |m| m.name == target.name }
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L131" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-delete-21">
            
              delete!(target)
            
          </h3>

          
            <div class="description">
              <p>Deletes a middleware from the middleware stack.</p>

<p>Returns the array of middlewares not including the deleted item, or raises <code>RuntimeError</code> if the target is not found.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 139
    def delete!(target)
      delete(target) || (raise &quot;No such middleware to remove: #{target.inspect}&quot;)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L139" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-each">
            
              each(&amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 81
    def each(&amp;block)
      @middlewares.each(&amp;block)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L81" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-initialize_copy">
            
              initialize_copy(other)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 102
    def initialize_copy(other)
      self.middlewares = other.middlewares.dup
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L102" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-insert">
            
              insert(index, klass, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="MiddlewareStack.html#method-i-insert_before">insert_before</a>
            </div>
          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 106
    def insert(index, klass, *args, &amp;block)
      index = assert_index(index, :before)
      middlewares.insert(index, build_middleware(klass, args, block))
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L106" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-insert_after">
            
              insert_after(index, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 114
    def insert_after(index, *args, &amp;block)
      index = assert_index(index, :after)
      insert(index + 1, *args, &amp;block)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L114" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-insert_before">
            
              insert_before(index, klass, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="MiddlewareStack.html#method-i-insert">insert</a>
            </div>
          

          
          
        </div>
        
        <div class="method">
          <h3 id="method-i-last">
            
              last()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 89
    def last
      middlewares.last
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L89" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-move">
            
              move(target, source)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          
            <div class="aka">
              Also aliased as: <a href="MiddlewareStack.html#method-i-move_before">move_before</a>
            </div>
          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 143
    def move(target, source)
      source_index = assert_index(source, :before)
      source_middleware = middlewares.delete_at(source_index)

      target_index = assert_index(target, :before)
      middlewares.insert(target_index, source_middleware)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L143" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-move_after">
            
              move_after(target, source)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 153
    def move_after(target, source)
      source_index = assert_index(source, :after)
      source_middleware = middlewares.delete_at(source_index)

      target_index = assert_index(target, :after)
      middlewares.insert(target_index + 1, source_middleware)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L153" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-move_before">
            
              move_before(target, source)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          
            <div class="aka">
              Alias for: <a href="MiddlewareStack.html#method-i-move">move</a>
            </div>
          

          
          
        </div>
        
        <div class="method">
          <h3 id="method-i-size">
            
              size()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 85
    def size
      middlewares.size
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L85" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-swap">
            
              swap(target, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 120
    def swap(target, *args, &amp;block)
      index = assert_index(target, :before)
      insert(index, *args, &amp;block)
      middlewares.delete_at(index + 1)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L120" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-unshift">
            
              unshift(klass, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 97
    def unshift(klass, *args, &amp;block)
      middlewares.unshift(build_middleware(klass, args, block))
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L97" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-use">
            
              use(klass, *args, &amp;block)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">ğŸ“ Source code</span>
              </summary>

              <pre><code class="ruby"># File actionpack/lib/action_dispatch/middleware/stack.rb, line 161
    def use(klass, *args, &amp;block)
      middlewares.push(build_middleware(klass, args, block))
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/dd8f7185faeca6ee968a6e9367f6d8601a83b8db/actionpack/lib/action_dispatch/middleware/stack.rb#L161" target="_blank" class="github_url">ğŸ” See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>
