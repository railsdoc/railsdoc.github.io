---
title: Object
layout: default
---
<div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 7.1.3</span><br />
        
        <div class="type">Class</div>
        <h1>
            Object
            
                <span class="parent">&lt;
                    
                    BasicObject
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/acts_like_rb.html">activesupport/lib/active_support/core_ext/object/acts_like.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/blank_rb.html">activesupport/lib/active_support/core_ext/object/blank.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/deep_dup_rb.html">activesupport/lib/active_support/core_ext/object/deep_dup.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/duplicable_rb.html">activesupport/lib/active_support/core_ext/object/duplicable.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/inclusion_rb.html">activesupport/lib/active_support/core_ext/object/inclusion.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/instance_variables_rb.html">activesupport/lib/active_support/core_ext/object/instance_variables.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/json_rb.html">activesupport/lib/active_support/core_ext/object/json.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/to_query_rb.html">activesupport/lib/active_support/core_ext/object/to_query.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/try_rb.html">activesupport/lib/active_support/core_ext/object/try.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/with_rb.html">activesupport/lib/active_support/core_ext/object/with.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/object/with_options_rb.html">activesupport/lib/active_support/core_ext/object/with_options.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/core_ext/string/output_safety_rb.html">activesupport/lib/active_support/core_ext/string/output_safety.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/hash_with_indifferent_access_rb.html">activesupport/lib/active_support/hash_with_indifferent_access.rb</a></li>
            
            <li><a href="../files/activesupport/lib/active_support/xml_mini/jdom_rb.html">activesupport/lib/active_support/xml_mini/jdom.rb</a></li>
            
            <li><a href="../files/railties/lib/rails/engine/commands_rb.html">railties/lib/rails/engine/commands.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  

  

  
  


  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-acts_like-3F">acts_like?</a>
        </li>
      
        <li>
          <a href="#method-i-blank-3F">blank?</a>
        </li>
      
        <li>
          <a href="#method-i-deep_dup">deep_dup</a>
        </li>
      
        <li>
          <a href="#method-i-duplicable-3F">duplicable?</a>
        </li>
      
        <li>
          <a href="#method-i-html_safe-3F">html_safe?</a>
        </li>
      
        <li>
          <a href="#method-i-in-3F">in?</a>
        </li>
      
        <li>
          <a href="#method-i-instance_values">instance_values</a>
        </li>
      
        <li>
          <a href="#method-i-instance_variable_names">instance_variable_names</a>
        </li>
      
        <li>
          <a href="#method-i-presence">presence</a>
        </li>
      
        <li>
          <a href="#method-i-presence_in">presence_in</a>
        </li>
      
        <li>
          <a href="#method-i-present-3F">present?</a>
        </li>
      
        <li>
          <a href="#method-i-to_param">to_param</a>
        </li>
      
        <li>
          <a href="#method-i-to_query">to_query</a>
        </li>
      
        <li>
          <a href="#method-i-try">try</a>
        </li>
      
        <li>
          <a href="#method-i-try-21">try!</a>
        </li>
      
        <li>
          <a href="#method-i-with">with</a>
        </li>
      
        <li>
          <a href="#method-i-with_options">with_options</a>
        </li>
      
    </ul>
  

  
    <!-- Includes -->
    <h2 id="included-modules">Included Modules</h2>
    <ul>
      
        <li>
          
            Java
          
        </li>
      
    </ul>
  

  
    

    

    
      <!-- Section constants -->
      <h2 id="constants">Constants</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">APP_PATH</td>
            <td>=</td>
            <td class="attr-value">File.expand_path(&quot;test/dummy/config/application&quot;, ENGINE_ROOT)</td>
          </tr>
          
        
      </table>
    

    

    <!-- Methods -->
    
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-acts_like-3F">
            
              acts_like?(duck)
            
          </h3>

          
            <div class="description">
              <p>Provides a way to check whether some class acts like some other class based on the existence of an appropriately-named marker method.</p>

<p>A class that provides the same interface as <code>SomeClass</code> may define a marker method named <code>acts_like_some_class?</code> to signal its compatibility to callers of <code>acts_like?(:some_class)</code>.</p>

<p>For example, Active Support extends <code>Date</code> to define an <code>acts_like_date?</code> method, and extends <code>Time</code> to define <code>acts_like_time?</code>. As a result, developers can call <code>x.acts_like?(:time)</code> and <code>x.acts_like?(:date)</code> to test duck-type compatibility, and classes that are able to act like <code>Time</code> can also define an <code>acts_like_time?</code> method to interoperate.</p>

<p>Note that the marker method is only expected to exist. It isn‚Äôt called, so its body or return value are irrelevant.</p>

<h4 id="method-i-acts_like-3F-label-Example-3A+A+class+that+provides+the+same+interface+as+String">Example: A class that provides the same interface as <code>String</code></h4>

<p>This class may define:</p>

<pre><code>class Stringish
  def acts_like_string?
  end
end
</code></pre>

<p>Then client code can query for duck-type-safeness this way:</p>

<pre><code>Stringish.new.acts_like?(:string) # =&gt; true
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/acts_like.rb, line 33
  def acts_like?(duck)
    case duck
    when :time
      respond_to? :acts_like_time?
    when :date
      respond_to? :acts_like_date?
    when :string
      respond_to? :acts_like_string?
    else
      respond_to? :&quot;acts_like_#{duck}?&quot;
    end
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/acts_like.rb#L33" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-blank-3F">
            
              blank?()
            
          </h3>

          
            <div class="description">
              <p>An object is blank if it‚Äôs false, empty, or a whitespace string. For example, <code>nil</code>, ‚Äù, ‚Äò   ‚Äô, [], {}, and <code>false</code> are all blank.</p>

<p>This simplifies</p>

<pre><code>!address || address.empty?
</code></pre>

<p>to</p>

<pre><code>address.blank?
</code></pre>

<p>@return [true, false]</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/blank.rb, line 18
  def blank?
    respond_to?(:empty?) ? !!empty? : !self
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/blank.rb#L18" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-deep_dup">
            
              deep_dup()
            
          </h3>

          
            <div class="description">
              <p>Returns a deep copy of object if it‚Äôs duplicable. If it‚Äôs not duplicable, returns <code>self</code>.</p>

<pre><code>object = Object.new
dup    = object.deep_dup
dup.instance_variable_set(:@a, 1)

object.instance_variable_defined?(:@a) # =&gt; false
dup.instance_variable_defined?(:@a)    # =&gt; true
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/deep_dup.rb, line 15
  def deep_dup
    duplicable? ? dup : self
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/deep_dup.rb#L15" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-duplicable-3F">
            
              duplicable?()
            
          </h3>

          
            <div class="description">
              <p>Can you safely dup this object?</p>

<p>False for method objects; true otherwise.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/duplicable.rb, line 26
  def duplicable?
    true
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/duplicable.rb#L26" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-html_safe-3F">
            
              html_safe?()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/string/output_safety.rb, line 7
  def html_safe?
    false
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/string/output_safety.rb#L7" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-in-3F">
            
              in?(another_object)
            
          </h3>

          
            <div class="description">
              <p>Returns true if this object is included in the argument.</p>

<p>When argument is a <code>Range</code>, <code>#cover?</code> is used to properly handle inclusion check within open ranges. Otherwise, argument must be any object which responds to <code>#include?</code>. Usage:</p>

<pre><code>characters = [&quot;Konata&quot;, &quot;Kagami&quot;, &quot;Tsukasa&quot;]
&quot;Konata&quot;.in?(characters) # =&gt; true
</code></pre>

<p>For non <code>Range</code> arguments, this will throw an <code>ArgumentError</code> if the argument doesn‚Äôt respond to <code>#include?</code>.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/inclusion.rb, line 15
  def in?(another_object)
    case another_object
    when Range
      another_object.cover?(self)
    else
      another_object.include?(self)
    end
  rescue NoMethodError
    raise ArgumentError.new(&quot;The parameter passed to #in? must respond to #include?&quot;)
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/inclusion.rb#L15" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-instance_values">
            
              instance_values()
            
          </h3>

          
            <div class="description">
              <p>Returns a hash with string keys that maps instance variable names without ‚Äú@‚Äù to their corresponding values.</p>

<pre><code>class C
  def initialize(x, y)
    @x, @y = x, y
  end
end

C.new(0, 1).instance_values # =&gt; {&quot;x&quot; =&gt; 0, &quot;y&quot; =&gt; 1}
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/instance_variables.rb, line 14
  def instance_values
    instance_variables.to_h do |ivar|
      [ivar[1..-1].freeze, instance_variable_get(ivar)]
    end
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/instance_variables.rb#L14" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-instance_variable_names">
            
              instance_variable_names()
            
          </h3>

          
            <div class="description">
              <p>Returns an array of instance variable names as strings including ‚Äú@‚Äù.</p>

<pre><code>class C
  def initialize(x, y)
    @x, @y = x, y
  end
end

C.new(0, 1).instance_variable_names # =&gt; [&quot;@y&quot;, &quot;@x&quot;]
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/instance_variables.rb, line 30
    def instance_variable_names
      instance_variables.map(&amp;:name)
    end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/instance_variables.rb#L30" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-presence">
            
              presence()
            
          </h3>

          
            <div class="description">
              <p>Returns the receiver if it‚Äôs present otherwise returns <code>nil</code>. <code>object.presence</code> is equivalent to</p>

<pre><code>object.present? ? object : nil
</code></pre>

<p>For example, something like</p>

<pre><code>state   = params[:state]   if params[:state].present?
country = params[:country] if params[:country].present?
region  = state || country || &#39;US&#39;
</code></pre>

<p>becomes</p>

<pre><code>region = params[:state].presence || params[:country].presence || &#39;US&#39;
</code></pre>

<p>@return [Object]</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/blank.rb, line 45
  def presence
    self if present?
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/blank.rb#L45" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-presence_in">
            
              presence_in(another_object)
            
          </h3>

          
            <div class="description">
              <p>Returns the receiver if it‚Äôs included in the argument otherwise returns <code>nil</code>. Argument must be any object which responds to <code>#include?</code>. Usage:</p>

<pre><code>params[:bucket_type].presence_in %w( project calendar )
</code></pre>

<p>This will throw an <code>ArgumentError</code> if the argument doesn‚Äôt respond to <code>#include?</code>.</p>

<p>@return [Object]</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/inclusion.rb, line 34
  def presence_in(another_object)
    in?(another_object) ? self : nil
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/inclusion.rb#L34" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-present-3F">
            
              present?()
            
          </h3>

          
            <div class="description">
              <p>An object is present if it‚Äôs not blank.</p>

<p>@return [true, false]</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/blank.rb, line 25
  def present?
    !blank?
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/blank.rb#L25" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-to_param">
            
              to_param()
            
          </h3>

          
            <div class="description">
              <p>Alias of <code>to_s</code>.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/to_query.rb, line 7
  def to_param
    to_s
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/to_query.rb#L7" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-to_query">
            
              to_query(key)
            
          </h3>

          
            <div class="description">
              <p>Converts an object into a string suitable for use as a URL query string, using the given <code>key</code> as the param name.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/to_query.rb, line 13
  def to_query(key)
    &quot;#{CGI.escape(key.to_param)}=#{CGI.escape(to_param.to_s)}&quot;
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/to_query.rb#L13" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-try">
            
              try(*args, &block)

            
          </h3>

          
            <div class="description">
              <p>Invokes the public method whose name goes as first argument just like <code>public_send</code> does, except that if the receiver does not respond to it the call returns <code>nil</code> rather than raising an exception.</p>

<p>This method is defined to be able to write</p>

<pre><code>@person.try(:name)
</code></pre>

<p>instead of</p>

<pre><code>@person.name if @person
</code></pre>

<p><code>try</code> calls can be chained:</p>

<pre><code>@person.try(:spouse).try(:name)
</code></pre>

<p>instead of</p>

<pre><code>@person.spouse.name if @person &amp;&amp; @person.spouse
</code></pre>

<p><code>try</code> will also return <code>nil</code> if the receiver does not respond to the method:</p>

<pre><code>@person.try(:non_existing_method) # =&gt; nil
</code></pre>

<p>instead of</p>

<pre><code>@person.non_existing_method if @person.respond_to?(:non_existing_method) # =&gt; nil
</code></pre>

<p><code>try</code> returns <code>nil</code> when called on <code>nil</code> regardless of whether it responds to the method:</p>

<pre><code>nil.try(:to_i) # =&gt; nil, rather than 0
</code></pre>

<p>Arguments and blocks are forwarded to the method if invoked:</p>

<pre><code>@posts.try(:each_slice, 2) do |a, b|
  ...
end
</code></pre>

<p>The number of arguments in the signature must match. If the object responds to the method the call is attempted and <code>ArgumentError</code> is still raised in case of argument mismatch.</p>

<p>If <code>try</code> is called without arguments it yields the receiver to a given block unless it is <code>nil</code>:</p>

<pre><code>@person.try do |p|
  ...
end
</code></pre>

<p>You can also call try with a block without accepting an argument, and the block will be instance_eval‚Äôed instead:</p>

<pre><code>@person.try { upcase.truncate(50) }
</code></pre>

<p>Please also note that <code>try</code> is defined on <code>Object</code>. Therefore, it won‚Äôt work with instances of classes that do not have <code>Object</code> among their ancestors, like direct subclasses of <code>BasicObject</code>.</p>
            </div>
          

          

          

          
          
            <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/try.rb#L39" target="_blank" class="github_url">üîé See on GitHub</a>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-try-21">
            
              try!(*args, &block)

            
          </h3>

          
            <div class="description">
              <p>Same as <a href="Object.html#method-i-try"><code>try</code></a>, but raises a <code>NoMethodError</code> exception if the receiver is not <code>nil</code> and does not implement the tried method.</p>

<pre><code>&quot;a&quot;.try!(:upcase) # =&gt; &quot;A&quot;
nil.try!(:upcase) # =&gt; nil
123.try!(:upcase) # =&gt; NoMethodError: undefined method `upcase&#39; for 123:Integer
</code></pre>
            </div>
          

          

          

          
          
            <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/try.rb#L104" target="_blank" class="github_url">üîé See on GitHub</a>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-with">
            
              with(**attributes)
            
          </h3>

          
            <div class="description">
              <p>Set and restore public attributes around a block.</p>

<pre><code>client.timeout # =&gt; 5
client.with(timeout: 1) do
  client.timeout # =&gt; 1
end
client.timeout # =&gt; 5
</code></pre>

<p>This method is a shorthand for the common begin/ensure pattern:</p>

<pre><code>old_value = object.attribute
begin
  object.attribute = new_value
  # do things
ensure
  object.attribute = old_value
end
</code></pre>

<p>It can be used on any object as long as both the reader and writer methods are public.</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/with.rb, line 24
  def with(**attributes)
    old_values = {}
    begin
      attributes.each do |key, value|
        old_values[key] = public_send(key)
        public_send(&quot;#{key}=&quot;, value)
      end
      yield
    ensure
      old_values.each do |key, old_value|
        public_send(&quot;#{key}=&quot;, old_value)
      end
    end
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/with.rb#L24" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-with_options">
            
              with_options(options, &amp;block)
            
          </h3>

          
            <div class="description">
              <p>An elegant way to factor duplication out of options passed to a series of method calls. Each method called in the block, with the block variable as the receiver, will have its options merged with the default <code>options</code> <code>Hash</code> or <code>Hash</code>-like object provided. Each method called on the block variable must take an options hash as its final argument.</p>

<p>Without <code>with_options</code>, this code contains duplication:</p>

<pre><code>class Account &lt; ActiveRecord::Base
  has_many :customers, dependent: :destroy
  has_many :products,  dependent: :destroy
  has_many :invoices,  dependent: :destroy
  has_many :expenses,  dependent: :destroy
end
</code></pre>

<p>Using <code>with_options</code>, we can remove the duplication:</p>

<pre><code>class Account &lt; ActiveRecord::Base
  with_options dependent: :destroy do |assoc|
    assoc.has_many :customers
    assoc.has_many :products
    assoc.has_many :invoices
    assoc.has_many :expenses
  end
end
</code></pre>

<p>It can also be used with an explicit receiver:</p>

<pre><code>I18n.with_options locale: user.locale, scope: &#39;newsletter&#39; do |i18n|
  subject i18n.t :subject
  body    i18n.t :body, user_name: user.name
end
</code></pre>

<p>When you don‚Äôt pass an explicit receiver, it executes the whole block in merging options context:</p>

<pre><code>class Account &lt; ActiveRecord::Base
  with_options dependent: :destroy do
    has_many :customers
    has_many :products
    has_many :invoices
    has_many :expenses
  end
end
</code></pre>

<p><code>with_options</code> can also be nested since the call is forwarded to its receiver.</p>

<p>NOTE: Each nesting level will merge inherited defaults in addition to their own.</p>

<pre><code>class Post &lt; ActiveRecord::Base
  with_options if: :persisted?, length: { minimum: 50 } do
    validates :content, if: -&gt; { content.present? }
  end
end
</code></pre>

<p>The code is equivalent to:</p>

<pre><code>validates :content, length: { minimum: 50 }, if: -&gt; { content.present? }
</code></pre>

<p>Hence the inherited default for <code>if</code> key is ignored.</p>

<p>NOTE: You cannot call class methods implicitly inside of <code>with_options</code>. You can access these methods using the class name instead:</p>

<pre><code>class Phone &lt; ActiveRecord::Base
  enum :phone_number_type, { home: 0, office: 1, mobile: 2 }

  with_options presence: true do
    validates :phone_number_type, inclusion: { in: Phone.phone_number_types.keys }
  end
end
</code></pre>

<p>When the block argument is omitted, the decorated <a href="Object.html"><code>Object</code></a> instance is returned:</p>

<pre><code>module MyStyledHelpers
  def styled
    with_options style: &quot;color: red;&quot;
  end
end

styled.link_to &quot;I&#39;m red&quot;, &quot;/&quot;
# =&gt; &lt;a href=&quot;/&quot; style=&quot;color: red;&quot;&gt;I&#39;m red&lt;/a&gt;

styled.button_tag &quot;I&#39;m red too!&quot;
# =&gt; &lt;button style=&quot;color: red;&quot;&gt;I&#39;m red too!&lt;/button&gt;
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activesupport/lib/active_support/core_ext/object/with_options.rb, line 92
  def with_options(options, &amp;block)
    option_merger = ActiveSupport::OptionMerger.new(self, options)

    if block
      block.arity.zero? ? option_merger.instance_eval(&amp;block) : block.call(option_merger)
    else
      option_merger
    end
  end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/36c1591bcb5e0ee3084759c7f42a706fe5bb7ca7/activesupport/lib/active_support/core_ext/object/with_options.rb#L92" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>
