---
title: ActiveRecord::Tasks::DatabaseTasks
layout: default
---
<div class="main">
    <div class="banner">
        
            <span>Ruby on Rails 7.2.2</span><br />
        
        <div class="type">Module</div>
        <h1>
            ActiveRecord::Tasks::DatabaseTasks
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/activerecord/lib/active_record/tasks/database_tasks_rb.html">activerecord/lib/active_record/tasks/database_tasks.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="module-ActiveRecord::Tasks::DatabaseTasks-label-Active+Record+DatabaseTasks">Active Record DatabaseTasks</h1>

<p><a href="DatabaseTasks.html"><code>ActiveRecord::Tasks::DatabaseTasks</code></a> is a utility class, which encapsulates logic behind common tasks used to manage database and migrations.</p>

<p>The tasks defined here are used with Rails commands provided by Active Record.</p>

<p>In order to use <a href="DatabaseTasks.html"><code>DatabaseTasks</code></a>, a few config values need to be set. All the needed config values are set by Rails already, so it‚Äôs necessary to do it only if you want to change the defaults or when you want to use Active Record outside of Rails (in such case after configuring the database tasks, you can also use the rake tasks defined in Active Record).</p>

<p>The possible config values are:</p>
<ul><li>
<p><code>env</code>: current environment (like <a href="../../Rails.html#method-c-env"><code>Rails.env</code></a>).</p>
</li><li>
<p><a href="DatabaseTasks.html#attribute-i-database_configuration"><code>database_configuration</code></a>: configuration of your databases (as in <code>config/database.yml</code>).</p>
</li><li>
<p><a href="DatabaseTasks.html#method-i-db_dir"><code>db_dir</code></a>: your <code>db</code> directory.</p>
</li><li>
<p><a href="DatabaseTasks.html#method-i-fixtures_path"><code>fixtures_path</code></a>: a path to fixtures directory.</p>
</li><li>
<p><a href="DatabaseTasks.html#method-i-migrations_paths"><code>migrations_paths</code></a>: a list of paths to directories with migrations.</p>
</li><li>
<p><a href="DatabaseTasks.html#method-i-seed_loader"><code>seed_loader</code></a>: an object which will load seeds, it needs to respond to the <a href="DatabaseTasks.html#method-i-load_seed"><code>load_seed</code></a> method.</p>
</li><li>
<p><code>root</code>: a path to the root of the application.</p>
</li></ul>

<p>Example usage of <a href="DatabaseTasks.html"><code>DatabaseTasks</code></a> outside Rails could look as such:</p>

<pre><code>include ActiveRecord::Tasks
DatabaseTasks.database_configuration = YAML.load_file(&#39;my_database_config.yml&#39;)
DatabaseTasks.db_dir = &#39;db&#39;
# other settings...

DatabaseTasks.create_current(&#39;production&#39;)
</code></pre>

    </div>
  

  

  
  


  

  
    <h2 id="methods">Methods</h2>
    <ul>
      
        <li>
          <a href="#method-i-cache_dump_filename">cache_dump_filename</a>
        </li>
      
        <li>
          <a href="#method-i-charset">charset</a>
        </li>
      
        <li>
          <a href="#method-i-charset_current">charset_current</a>
        </li>
      
        <li>
          <a href="#method-i-check_protected_environments-21">check_protected_environments!</a>
        </li>
      
        <li>
          <a href="#method-i-check_schema_file">check_schema_file</a>
        </li>
      
        <li>
          <a href="#method-i-check_target_version">check_target_version</a>
        </li>
      
        <li>
          <a href="#method-i-clear_schema_cache">clear_schema_cache</a>
        </li>
      
        <li>
          <a href="#method-i-collation">collation</a>
        </li>
      
        <li>
          <a href="#method-i-collation_current">collation_current</a>
        </li>
      
        <li>
          <a href="#method-i-create">create</a>
        </li>
      
        <li>
          <a href="#method-i-create_all">create_all</a>
        </li>
      
        <li>
          <a href="#method-i-create_current">create_current</a>
        </li>
      
        <li>
          <a href="#method-i-db_dir">db_dir</a>
        </li>
      
        <li>
          <a href="#method-i-drop">drop</a>
        </li>
      
        <li>
          <a href="#method-i-drop_all">drop_all</a>
        </li>
      
        <li>
          <a href="#method-i-drop_current">drop_current</a>
        </li>
      
        <li>
          <a href="#method-i-dump_schema_cache">dump_schema_cache</a>
        </li>
      
        <li>
          <a href="#method-i-env">env</a>
        </li>
      
        <li>
          <a href="#method-i-fixtures_path">fixtures_path</a>
        </li>
      
        <li>
          <a href="#method-i-load_schema_current">load_schema_current</a>
        </li>
      
        <li>
          <a href="#method-i-load_seed">load_seed</a>
        </li>
      
        <li>
          <a href="#method-i-migrate">migrate</a>
        </li>
      
        <li>
          <a href="#method-i-migrate_status">migrate_status</a>
        </li>
      
        <li>
          <a href="#method-i-migrations_paths">migrations_paths</a>
        </li>
      
        <li>
          <a href="#method-i-name">name</a>
        </li>
      
        <li>
          <a href="#method-i-prepare_all">prepare_all</a>
        </li>
      
        <li>
          <a href="#method-i-purge">purge</a>
        </li>
      
        <li>
          <a href="#method-i-purge_all">purge_all</a>
        </li>
      
        <li>
          <a href="#method-i-purge_current">purge_current</a>
        </li>
      
        <li>
          <a href="#method-i-register_task">register_task</a>
        </li>
      
        <li>
          <a href="#method-i-root">root</a>
        </li>
      
        <li>
          <a href="#method-i-schema_dump_path">schema_dump_path</a>
        </li>
      
        <li>
          <a href="#method-i-schema_up_to_date-3F">schema_up_to_date?</a>
        </li>
      
        <li>
          <a href="#method-i-seed_loader">seed_loader</a>
        </li>
      
        <li>
          <a href="#method-i-structure_dump">structure_dump</a>
        </li>
      
        <li>
          <a href="#method-c-structure_dump_flags">structure_dump_flags</a>
        </li>
      
        <li>
          <a href="#method-i-structure_load">structure_load</a>
        </li>
      
        <li>
          <a href="#method-c-structure_load_flags">structure_load_flags</a>
        </li>
      
        <li>
          <a href="#method-i-target_version">target_version</a>
        </li>
      
        <li>
          <a href="#method-i-truncate_all">truncate_all</a>
        </li>
      
    </ul>
  

  

  
    

    

    
      <!-- Section constants -->
      <h2 id="constants">Constants</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">LOCAL_HOSTS</td>
            <td>=</td>
            <td class="attr-value">[&quot;127.0.0.1&quot;, &quot;localhost&quot;]</td>
          </tr>
          
        
      </table>
    

    
      <!-- Section attributes -->
      <h2 id="attributes">Attributes</h2>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>database_configuration</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>db_dir</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>env</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>fixtures_path</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>migrations_paths</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>root</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [W]
            </td>
            <td class='attr-name'>seed_loader</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    

    <!-- Methods -->
    
      <h2 id="class-public-methods">Class Public methods</h2>
      
        <div class="method">
          <h3 id="method-c-structure_dump_flags">
            
              structure_dump_flags
            
          </h3>

          
            <div class="description">
              <p>Extra flags passed to database CLI tool (mysqldump/pg_dump) when calling db:schema:dump It can be used as a string/array (the typical case) or a hash (when you use multiple adapters) Example:</p>

<pre><code>ActiveRecord::Tasks::DatabaseTasks.structure_dump_flags = {
  mysql2: [&#39;--no-defaults&#39;, &#39;--skip-add-drop-table&#39;],
  postgres: &#39;--no-tablespaces&#39;
}
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 50
      mattr_accessor :structure_dump_flags, instance_accessor: false
</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L50" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-c-structure_load_flags">
            
              structure_load_flags
            
          </h3>

          
            <div class="description">
              <p>Extra flags passed to database CLI tool when calling db:schema:load It can be used as a string/array (the typical case) or a hash (when you use multiple adapters)</p>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 56
      mattr_accessor :structure_load_flags, instance_accessor: false
</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L56" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
      <h2 id="instance-public-methods">Instance Public methods</h2>
      
        <div class="method">
          <h3 id="method-i-cache_dump_filename">
            
              cache_dump_filename(db_config_or_name, schema_cache_path: nil)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 460
      def cache_dump_filename(db_config_or_name, schema_cache_path: nil)
        if db_config_or_name.is_a?(DatabaseConfigurations::DatabaseConfig)
          schema_cache_path ||
            db_config_or_name.schema_cache_path ||
            schema_cache_env ||
            db_config_or_name.default_schema_cache_path(ActiveRecord::Tasks::DatabaseTasks.db_dir)
        else
          ActiveRecord.deprecator.warn(&lt;&lt;~MSG.squish)
            Passing a database name to `cache_dump_filename` is deprecated and will be removed in Rails 8.0. Pass a
            `ActiveRecord::DatabaseConfigurations::DatabaseConfig` object instead.
          MSG

          filename = if ActiveRecord::Base.configurations.primary?(db_config_or_name)
            &quot;schema_cache.yml&quot;
          else
            &quot;#{db_config_or_name}_schema_cache.yml&quot;
          end

          schema_cache_path || schema_cache_env || File.join(ActiveRecord::Tasks::DatabaseTasks.db_dir, filename)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L460" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-charset">
            
              charset(configuration, *arguments)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 324
      def charset(configuration, *arguments)
        db_config = resolve_configuration(configuration)
        database_adapter_for(db_config, *arguments).charset
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L324" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-charset_current">
            
              charset_current(env_name = env, db_name = name)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 319
      def charset_current(env_name = env, db_name = name)
        db_config = configs_for(env_name: env_name, name: db_name)
        charset(db_config)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L319" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-check_protected_environments-21">
            
              check_protected_environments!(environment = env)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 65
      def check_protected_environments!(environment = env)
        return if ENV[&quot;DISABLE_DATABASE_ENVIRONMENT_CHECK&quot;]

        configs_for(env_name: environment).each do |db_config|
          check_current_protected_environment!(db_config)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L65" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-check_schema_file">
            
              check_schema_file(filename)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 490
      def check_schema_file(filename)
        unless File.exist?(filename)
          message = +%{#{filename} doesn&#39;t exist yet. Run `bin/rails db:migrate` to create it, then try again.}
          message &lt;&lt; %{ If you do not intend to use a database, you should instead alter #{Rails.root}/config/application.rb to limit the frameworks that will be loaded.} if defined?(::Rails.root)
          Kernel.abort message
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L490" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-check_target_version">
            
              check_target_version()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 309
      def check_target_version
        if target_version &amp;&amp; !Migration.valid_version_format?(ENV[&quot;VERSION&quot;])
          raise &quot;Invalid format of target version: `VERSION=#{ENV[&#39;VERSION&#39;]}`&quot;
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L309" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-clear_schema_cache">
            
              clear_schema_cache(filename)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 516
      def clear_schema_cache(filename)
        FileUtils.rm_f filename, verbose: false
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L516" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-collation">
            
              collation(configuration, *arguments)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 334
      def collation(configuration, *arguments)
        db_config = resolve_configuration(configuration)
        database_adapter_for(db_config, *arguments).collation
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L334" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-collation_current">
            
              collation_current(env_name = env, db_name = name)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 329
      def collation_current(env_name = env, db_name = name)
        db_config = configs_for(env_name: env_name, name: db_name)
        collation(db_config)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L329" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-create">
            
              create(configuration, *arguments)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 115
      def create(configuration, *arguments)
        db_config = resolve_configuration(configuration)
        database_adapter_for(db_config, *arguments).create
        $stdout.puts &quot;Created database &#39;#{db_config.database}&#39;&quot; if verbose?
      rescue DatabaseAlreadyExists
        $stderr.puts &quot;Database &#39;#{db_config.database}&#39; already exists&quot; if verbose?
      rescue Exception =&gt; error
        $stderr.puts error
        $stderr.puts &quot;Couldn&#39;t create &#39;#{db_config.database}&#39; database. Please check your configuration.&quot;
        raise
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L115" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-create_all">
            
              create_all()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 127
      def create_all
        db_config = migration_connection.pool.db_config

        each_local_configuration { |db_config| create(db_config) }

        migration_class.establish_connection(db_config)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L127" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-create_current">
            
              create_current(environment = env, name = nil)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 170
      def create_current(environment = env, name = nil)
        each_current_configuration(environment, name) { |db_config| create(db_config) }

        migration_class.establish_connection(environment.to_sym)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L170" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-db_dir">
            
              db_dir()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 83
      def db_dir
        @db_dir ||= Rails.application.config.paths[&quot;db&quot;].first
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L83" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-drop">
            
              drop(configuration, *arguments)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 223
      def drop(configuration, *arguments)
        db_config = resolve_configuration(configuration)
        database_adapter_for(db_config, *arguments).drop
        $stdout.puts &quot;Dropped database &#39;#{db_config.database}&#39;&quot; if verbose?
      rescue ActiveRecord::NoDatabaseError
        $stderr.puts &quot;Database &#39;#{db_config.database}&#39; does not exist&quot;
      rescue Exception =&gt; error
        $stderr.puts error
        $stderr.puts &quot;Couldn&#39;t drop database &#39;#{db_config.database}&#39;&quot;
        raise
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L223" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-drop_all">
            
              drop_all()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 235
      def drop_all
        each_local_configuration { |db_config| drop(db_config) }
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L235" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-drop_current">
            
              drop_current(environment = env)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 239
      def drop_current(environment = env)
        each_current_configuration(environment) { |db_config| drop(db_config) }
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L239" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-dump_schema_cache">
            
              dump_schema_cache(conn_or_pool, filename)
            
          </h3>

          
            <div class="description">
              <p>Dumps the schema cache in YAML format for the connection into the file</p>

<h4 id="method-i-dump_schema_cache-label-Examples">Examples</h4>

<pre><code>ActiveRecord::Tasks::DatabaseTasks.dump_schema_cache(ActiveRecord::Base.lease_connection, &quot;tmp/schema_dump.yaml&quot;)
</code></pre>
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 512
      def dump_schema_cache(conn_or_pool, filename)
        conn_or_pool.schema_cache.dump_to(filename)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L512" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-env">
            
              env()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 103
      def env
        @env ||= Rails.env
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L103" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-fixtures_path">
            
              fixtures_path()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 91
      def fixtures_path
        @fixtures_path ||= if ENV[&quot;FIXTURES_PATH&quot;]
          File.join(root, ENV[&quot;FIXTURES_PATH&quot;])
        else
          File.join(root, &quot;test&quot;, &quot;fixtures&quot;)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L91" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-load_schema_current">
            
              load_schema_current(format = ActiveRecord.schema_format, file = nil, environment = env)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 482
      def load_schema_current(format = ActiveRecord.schema_format, file = nil, environment = env)
        each_current_configuration(environment) do |db_config|
          with_temporary_connection(db_config) do
            load_schema(db_config, format, file)
          end
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L482" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-load_seed">
            
              load_seed()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 498
      def load_seed
        if seed_loader
          seed_loader.load_seed
        else
          raise &quot;You tried to load seed data, but no seed loader is specified. Please specify seed &quot; \
                &quot;loader with ActiveRecord::Tasks::DatabaseTasks.seed_loader = your_seed_loader\n&quot; \
                &quot;Seed loader should respond to load_seed method&quot;
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L498" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-migrate">
            
              migrate(version = nil)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 256
      def migrate(version = nil)
        scope = ENV[&quot;SCOPE&quot;]
        verbose_was, Migration.verbose = Migration.verbose, verbose?

        check_target_version

        migration_connection_pool.migration_context.migrate(target_version) do |migration|
          if version.blank?
            scope.blank? || scope == migration.scope
          else
            migration.version == version
          end
        end.tap do |migrations_ran|
          Migration.write(&quot;No migrations ran. (using #{scope} scope)&quot;) if scope.present? &amp;&amp; migrations_ran.empty?
        end

        migration_connection_pool.schema_cache.clear!
      ensure
        Migration.verbose = verbose_was
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L256" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-migrate_status">
            
              migrate_status()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 294
      def migrate_status
        unless migration_connection_pool.schema_migration.table_exists?
          Kernel.abort &quot;Schema migrations table does not exist yet.&quot;
        end

        # output
        puts &quot;\ndatabase: #{migration_connection_pool.db_config.database}\n\n&quot;
        puts &quot;#{&#39;Status&#39;.center(8)}  #{&#39;Migration ID&#39;.ljust(14)}  Migration Name&quot;
        puts &quot;-&quot; * 50
        migration_connection_pool.migration_context.migrations_status.each do |status, version, name|
          puts &quot;#{status.center(8)}  #{version.ljust(14)}  #{name}&quot;
        end
        puts
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L294" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-migrations_paths">
            
              migrations_paths()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 87
      def migrations_paths
        @migrations_paths ||= Rails.application.paths[&quot;db/migrate&quot;].to_a
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L87" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-name">
            
              name()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 107
      def name
        @name ||= &quot;primary&quot;
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L107" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-prepare_all">
            
              prepare_all()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 176
      def prepare_all
        seed = false
        dump_db_configs = []

        each_current_configuration(env) do |db_config|
          with_temporary_pool(db_config) do
            begin
              database_initialized = migration_connection_pool.schema_migration.table_exists?
            rescue ActiveRecord::NoDatabaseError
              create(db_config)
              retry
            end

            unless database_initialized
              if File.exist?(schema_dump_path(db_config))
                load_schema(db_config, ActiveRecord.schema_format, nil)
              end

              seed = true
            end
          end
        end

        each_current_environment(env) do |environment|
          db_configs_with_versions(environment).sort.each do |version, db_configs|
            dump_db_configs |= db_configs

            db_configs.each do |db_config|
              with_temporary_pool(db_config) do
                migrate(version)
              end
            end
          end
        end

        # Dump schema for databases that were migrated.
        if ActiveRecord.dump_schema_after_migration
          dump_db_configs.each do |db_config|
            with_temporary_pool(db_config) do
              dump_schema(db_config)
            end
          end
        end

        load_seed if seed
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L176" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-purge">
            
              purge(configuration)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 339
      def purge(configuration)
        db_config = resolve_configuration(configuration)
        database_adapter_for(db_config).purge
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L339" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-purge_all">
            
              purge_all()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 344
      def purge_all
        each_local_configuration { |db_config| purge(db_config) }
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L344" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-purge_current">
            
              purge_current(environment = env)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 348
      def purge_current(environment = env)
        each_current_configuration(environment) { |db_config| purge(db_config) }

        migration_class.establish_connection(environment.to_sym)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L348" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-register_task">
            
              register_task(pattern, task)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 73
      def register_task(pattern, task)
        @tasks ||= {}
        @tasks[pattern] = task
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L73" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-root">
            
              root()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 99
      def root
        @root ||= Rails.root
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L99" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-schema_dump_path">
            
              schema_dump_path(db_config, format = ActiveRecord.schema_format)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 447
      def schema_dump_path(db_config, format = ActiveRecord.schema_format)
        return ENV[&quot;SCHEMA&quot;] if ENV[&quot;SCHEMA&quot;]

        filename = db_config.schema_dump(format)
        return unless filename

        if File.dirname(filename) == ActiveRecord::Tasks::DatabaseTasks.db_dir
          filename
        else
          File.join(ActiveRecord::Tasks::DatabaseTasks.db_dir, filename)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L447" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-schema_up_to_date-3F">
            
              schema_up_to_date?(configuration, format = ActiveRecord.schema_format, file = nil)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 389
      def schema_up_to_date?(configuration, format = ActiveRecord.schema_format, file = nil)
        db_config = resolve_configuration(configuration)

        file ||= schema_dump_path(db_config)

        return true unless file &amp;&amp; File.exist?(file)

        with_temporary_pool(db_config) do |pool|
          internal_metadata = pool.internal_metadata
          return false unless internal_metadata.enabled?
          return false unless internal_metadata.table_exists?

          internal_metadata[:schema_sha1] == schema_sha1(file)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L389" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-seed_loader">
            
              seed_loader()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 111
      def seed_loader
        @seed_loader ||= Rails.application
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L111" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-structure_dump">
            
              structure_dump(configuration, *arguments)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 354
      def structure_dump(configuration, *arguments)
        db_config = resolve_configuration(configuration)
        filename = arguments.delete_at(0)
        flags = structure_dump_flags_for(db_config.adapter)
        database_adapter_for(db_config, *arguments).structure_dump(filename, flags)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L354" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-structure_load">
            
              structure_load(configuration, *arguments)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 361
      def structure_load(configuration, *arguments)
        db_config = resolve_configuration(configuration)
        filename = arguments.delete_at(0)
        flags = structure_load_flags_for(db_config.adapter)
        database_adapter_for(db_config, *arguments).structure_load(filename, flags)
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L361" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-target_version">
            
              target_version()
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 315
      def target_version
        ENV[&quot;VERSION&quot;].to_i if ENV[&quot;VERSION&quot;] &amp;&amp; !ENV[&quot;VERSION&quot;].empty?
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L315" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
        <div class="method">
          <h3 id="method-i-truncate_all">
            
              truncate_all(environment = env)
            
          </h3>

          
            <div class="description">
              
            </div>
          

          

          

          
          
            <details class="method__source">
              <summary>
                <span class="label">üìù Source code</span>
              </summary>

              <pre><code class="ruby"># File activerecord/lib/active_record/tasks/database_tasks.rb, line 250
      def truncate_all(environment = env)
        configs_for(env_name: environment).each do |db_config|
          truncate_tables(db_config)
        end
      end</code></pre>
              
                <a href="https://github.com/rails/rails/blob/d0dcb8fa6073a0c4d42600c15e82e3bb386b27d3/activerecord/lib/active_record/tasks/database_tasks.rb#L250" target="_blank" class="github_url">üîé See on GitHub</a>
              
            </details>
          
        </div>
        
      
    
  
</div>

    </div>
</div>
